# MLOps Project 2: Containerized Training Pipeline

This repository contains the solution for Project 2, demonstrating the containerization of a PyTorch Lightning training pipeline using Docker.

The project refactors a Jupyter Notebook into a set of modular Python scripts (data.py, model.py, train.py) and packages the entire training environment into a portable Docker image. The model fine-tunes distilbert-base-uncased on the GLUE mrpc dataset and logs all experiments to Weights & Biases (W&B).

The requirements.txt is specifically configured to install the CPU-only version of PyTorch. This was a necessary adaptation (as documented in Task 3) to build the image on low memory cloud platforms like Docker Playground, which would fail due to the full PyTorch package size.

## How to Run This Project

This project can be run locally on any machine with Docker installed, or in a cloud environment like GitHub Codespaces.

### Prerequisites

* You must have Docker Desktop installed and running.
* You must have a Weights & Biases (W&B) account to log and view the training run.

### Step 1: Clone the Repository

```bash
git clone https://github.com/joelolessayil/mlops-project-2.git
cd mlops-project-2
```

### Step 2: Build the Docker Image

This command reads the Dockerfile, installs all dependencies from requirements.txt, and builds the local image, tagging it as newcrosoft-project.

```bash
docker build -t newcrosoft-project .
```

### Step 3: Run the Training Container

This command will start a new container from the image, securely pass your W&B API key as an environment variable, and run the training script. The --rm flag automatically deletes the container after the run is complete.

1. First, get your W&B API Key from: wandb.ai/authorize

2. Run the command below, replacing "YOUR_KEY_HERE" with your actual key:

```bash
docker run --rm -e WANDB_API_KEY="YOUR_KEY_HERE" newcrosoft-project
```

## Running on Docker Playground (Task 3)

This project was successfully tested in a clean cloud environment using Docker Playground.

1. Go to labs.play-with-docker.com and log in.

2. Click "+ ADD NEW INSTANCE".

3. A terminal will appear. Run the exact same commands from Step 1, Step 2, and Step 3 in this new terminal.

4. (Note: Docker Playground is a free service and is often "out of capacity". If it fails to create a session, you may need to try again later, or use the GitHub Codespaces alternative.)

## Verifying the Runs

You will see the training progress log directly to your terminal. All runs are logged to a public W&B project: newcrosoft-project-2.
The train.py script is configured with a --run_tag to identify the source of each run:

* [local_py]-...: (Task 1) This run is generated by running python train.py directly on a local machine.

* [docker_build]-...: (Task 2 & 3) These runs are generated by the docker run command. You will have two of these:

1. One from your local machine (Task 2).

2. One from your cloud environment (GitHub Codespaces or Docker Playground) (Task 3).

You can inspect the "Host" metadata in the W&B run overview to see the machine name (e.g., Joels-Laptop vs. a cloud instance ID) that executed each [docker_build].
